<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{city_meta_title}</title>
    <meta name="description" content="{city_meta_description}">
    <link rel="canonical" href="https://{domain}/city/{city_slug}/">
    <meta property="og:title" content="{city_og_title}">
    <meta property="og:description" content="{city_og_description}">
    <meta property="og:url" content="https://{domain}/city/{city_slug}/">
    <!-- CSS same as index.html -->
    <style>/* ... full CSS (copy from index.html) ... */</style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">{site_logo_text}<span>{site_logo_icon}</span>.pro</a>
                <nav>
                    <ul class="nav-menu">
                        <li><a href="/">Home</a></li>
                        <li><a href="/states/">States</a></li>
                        <li><a href="/cities/">Cities</a></li>
                        <li><a href="/calculator/">Calculator</a></li>
                        <li><a href="/blog/">Blog</a></li>
                    </ul>
                </nav>
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="üîç Search another city...">
                </div>
                <a href="tel:{city_emergency_phone}" class="emergency-btn">
                    <i class="fas fa-phone-alt"></i> 24/7
                </a>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="breadcrumb" style="display:flex; gap:10px; color:#999; margin:20px 0;">
            <a href="/" style="color:#ffcc00;">Home</a>
            <i class="fas fa-chevron-right"></i>
            <a href="/state/{state_slug}/" style="color:#ffcc00;">{state_name}</a>
            <i class="fas fa-chevron-right"></i>
            <span style="color:#fff;">{city_name}</span>
        </div>
    </div>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Water Damage Restoration in {city_name}, {state_code}</h1>
                <div class="hero-subheadings">
                    <span class="hero-subheading"><i class="fas fa-clock"></i> {response_time_hours}hr Response</span>
                    <span class="hero-subheading"><i class="fas fa-tag"></i> ${avg_cost_min} - ${avg_cost_max} Avg</span>
                    <span class="hero-subheading"><i class="fas fa-certificate"></i> IICRC Certified</span>
                </div>
                <div class="hero-buttons">
                    <a href="#estimate" class="btn btn-primary">üìã Get Free Estimate</a>
                    <a href="tel:{city_phone}" class="btn btn-outline">üìû Call Now</a>
                </div>
                <div style="margin-top:20px;">
                    <a href="/calculator/?city={city_slug}" class="btn btn-outline" style="border-color:#ffcc00;">
                        üßÆ Try Our Cost Calculator
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="container">
        <div class="trust-badges">
            <span class="trust-badge"><i class="fas fa-certificate"></i> {certification_1}</span>
            <span class="trust-badge"><i class="fas fa-check-circle"></i> {certification_2}</span>
            <span class="trust-badge"><i class="fas fa-star"></i> {certification_3}</span>
            <span class="trust-badge"><i class="fas fa-clock"></i> {response_time_hours}hr Response</span>
        </div>
    </div>

    <div class="container">
        <div class="adsense-container">
            <div class="adsense-label">ADVERTISEMENT</div>
            <div class="adsense-placeholder">{adsense_top_code}</div>
        </div>
    </div>

    <section class="form-section" id="estimate">
        <div class="container">
            <div class="form-grid">
                <div class="form-content">
                    <h2><span style="color:#ffcc00;">{city_name}</span> Free Estimate</h2>
                    <p>No obligation ‚Ä¢ {response_time_hours}hr response ‚Ä¢ Insurance approved</p>
                    <div style="background:#1a1a1a; border:1px solid #333; border-radius:20px; padding:25px; margin-top:25px;">
                        <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                            <span style="color:#999;">Average Cost</span>
                            <span style="font-size:28px; font-weight:800; color:#28a745;">${avg_cost_min} - ${avg_cost_max}</span>
                        </div>
                        <div style="display:flex; justify-content:space-between;">
                            <span style="color:#999;">Response Time</span>
                            <span style="font-weight:700; color:#ffcc00;">{response_time_hours} hours</span>
                        </div>
                    </div>
                </div>
                <div class="form-fields">
                    <form action="https://formspree.io/f/{formspree_id}" method="POST">
                        <input type="hidden" name="city" value="{city_name}">
                        <input type="hidden" name="state" value="{state_code}">
                        <input type="hidden" name="source" value="city_page">
                        <div class="form-group">
                            <input type="text" name="name" placeholder="Full Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" name="email" placeholder="Email Address" required>
                        </div>
                        <div class="form-group">
                            <input type="tel" name="phone" placeholder="Phone Number" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="zip" placeholder="ZIP Code" required>
                        </div>
                        <button type="submit" class="submit-btn">Get Free Estimate</button>
                        <div class="form-disclaimer">
                            üîí By submitting, you agree to our Privacy Policy. {disclosure_text}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Affiliate Offers (from Affiliate_Programs) -->
    <div class="container" id="affiliateOffers"></div>

    <!-- Services Grid (from Cities tab) -->
    <div class="container">
        <h2 style="color:#ffcc00; margin-bottom:20px;">üõ†Ô∏è Our {city_name} Services</h2>
        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px;">
            <div style="background:#111; border:1px solid #333; border-radius:20px; padding:20px;">
                <h3 style="color:#fff;">{service_1_name}</h3>
                <p style="color:#ccc;">{service_1_description}</p>
                <p style="color:#28a745; font-weight:700; margin-top:15px;">${service_1_price_min} - ${service_1_price_max}</p>
            </div>
            <!-- repeat for services 2-5 -->
        </div>
    </div>

    <!-- Testimonials -->
    <div class="container">
        <h2 style="color:#ffcc00; margin-bottom:20px;">‚≠ê What {city_name} Homeowners Say</h2>
        <div class="testimonials-grid" id="cityTestimonials"></div>
    </div>

    <!-- Nearby Cities -->
    <div class="container">
        <h2 style="color:#ffcc00; margin-bottom:20px;">üìç Nearby Cities</h2>
        <div class="cities-grid" id="nearbyCities"></div>
    </div>

    <!-- FAQ -->
    <div class="container">
        <div class="faq-section">
            <h2 style="color:#fff; text-align:center;">‚ùì {city_name} Water Damage FAQs</h2>
            <div class="faq-grid" id="cityFaq"></div>
        </div>
    </div>

    <footer class="footer">
        <!-- same as index.html footer -->
    </footer>

    <script>
        // Data injection (Apps Script will replace these)
        window.cityData = {city_json};
        window.affiliateData = {affiliate_json};
        window.testimonialsData = {testimonials_json};
        window.nearbyCitiesData = {nearby_json};
        window.faqData = {faq_json};

        // Render affiliate offers
        const affEl = document.getElementById('affiliateOffers');
        if (affEl && window.affiliateData) {
            affEl.innerHTML = window.affiliateData.slice(0,2).map(a => `
                <div style="background:#111; border:1px solid #333; border-radius:20px; padding:20px; margin-bottom:15px; display:flex; align-items:center; justify-content:space-between;">
                    <div style="display:flex; align-items:center; gap:15px;">
                        <div style="width:50px; height:50px; background:#ffcc00; border-radius:50%; display:flex; align-items:center; justify-content:center;">
                            <i class="fas fa-tools" style="font-size:24px; color:#000;"></i>
                        </div>
                        <div>
                            <h4 style="color:#fff;">${a.affiliate_name}</h4>
                            <p style="color:#ccc;">Exclusive offer for {city_name} residents</p>
                        </div>
                    </div>
                    <a href="${a.affiliate_deep_link_base}?city={city_slug}" class="btn btn-primary" style="width:auto; padding:12px 24px;" target="_blank" rel="nofollow sponsored">
                        Shop Now <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            `).join('');
        }

        // Render city testimonials
        const testEl = document.getElementById('cityTestimonials');
        if (testEl && window.testimonialsData) {
            testEl.innerHTML = window.testimonialsData.map(t => `
                <div class="testimonial-card">
                    <div class="testimonial-rating">${'<i class="fas fa-star"></i>'.repeat(t.rating||5)}</div>
                    <p class="testimonial-text">"${t.review_content}"</p>
                    <div class="testimonial-author">
                        <div><h4>${t.customer_name}</h4><p>${t.customer_city}, Verified Homeowner</p></div>
                    </div>
                </div>
            `).join('');
        }

        // Render nearby cities
        const nearbyEl = document.getElementById('nearbyCities');
        if (nearbyEl && window.nearbyCitiesData) {
            nearbyEl.innerHTML = window.nearbyCitiesData.map(c => `
                <a href="/city/${c.city_slug}/" class="city-card">
                    <div class="city-name">${c.city_name}</div>
                    <div class="city-price">$${c.avg_cost_min} - $${c.avg_cost_max}</div>
                    <div class="city-response"><i class="fas fa-car"></i> ${c.distance} miles</div>
                </a>
            `).join('');
        }

        // Render FAQ
        const faqEl = document.getElementById('cityFaq');
        if (faqEl && window.faqData) {
            faqEl.innerHTML = window.faqData.map((f,i) => `
                <div class="faq-item ${i===0?'active':''}">
                    <div class="faq-question">
                        <span>${f.question}</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer" style="${i===0?'display:block;':'display:none;'}">${f.answer}</div>
                </div>
            `).join('');
        }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": "Water Damage Restoration {city_name}",
        "url": "https://{domain}/city/{city_slug}/",
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "{city_name}",
            "addressRegion": "{state_code}",
            "addressCountry": "US"
        },
        "priceRange": "$${avg_cost_min} - $${avg_cost_max}",
        "telephone": "{city_phone}"
    }
    </script>
</body>
</html>
